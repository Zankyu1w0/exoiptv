#:import hex kivy.utils.get_color_from_hex
#:import Factory kivy.factory.Factory

ScreenManager:
    AnaEkran:
        name: 'ana'
    OynaticiEkran:
        name: 'oynat'

<AnaEkran>:
    BoxLayout:
        orientation: 'vertical'
        canvas.before:
            Color:
                rgba: 0, 0, 0, 1 # body background-color: #000000
            Rectangle:
                pos: self.pos
                size: self.size

        # .header sınıfı
        BoxLayout:
            size_hint_y: None
            height: "76dp"
            padding: "10dp"
            spacing: "10dp"
            canvas.before:
                Color:
                    rgba: hex('#172b43cc') # background-color: rgba(23, 43, 67, 0.8)
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            AsyncImage:
                source: "https://i.hizliresim.com/t75soiq.png"
                size_hint: None, None
                size: "55dp", "55dp"
            
            Label:
                text: "TITAN TV"
                color: hex('#e1e1e1')
                font_size: "16sp"
                bold: True
                halign: "left"
                text_size: self.size
                valign: "middle"

        ScrollView:
            GridLayout:
                id: list_container
                cols: 1
                size_hint_y: None
                height: self.minimum_height
                
                # HTML kanal-item döngüsü
                Widget:
                    size_hint_y: None
                    height: 0
                    on_parent:
                        for kanal in root.kanallar: \
                        item = Factory.ChannelItem(); \
                        item.text = kanal['text']; \
                        item.logo = kanal['logo']; \
                        item.url = kanal['url']; \
                        list_container.add_widget(item)

# .channel-item sınıfı
<ChannelItem@ButtonBehavior+BoxLayout>:
    text: ""
    logo: ""
    url: ""
    size_hint_y: None
    height: "75dp"
    padding: ["10dp", "0dp"]
    spacing: "10dp"
    on_release: app.kanal_ac(self.url)
    canvas.before:
        Color:
            rgba: hex('#16202a') # background-color: #16202a
        Rectangle:
            pos: self.pos
            size: self.size
        Color:
            rgba: hex('#9400d3') # border-bottom: 2px solid #9400d3
        Line:
            points: [self.x, self.y, self.x + self.width, self.y]
            width: 1.1

    AsyncImage:
        source: root.logo
        size_hint: None, None
        size: "55dp", "55dp"
        pos_hint: {"center_y": .5}
    
    Label:
        text: root.text
        color: hex('#e1e1e1')
        font_size: "16sp"
        halign: "left"
        text_size: self.size
        valign: "middle"

<OynaticiEkran>:
    BoxLayout:
        orientation: 'vertical'
        VideoPlayer:
            id: player
            options: {'allow_stretch': True}
        Button:
            text: "ANA SAYFAYA DÖN"
            size_hint_y: None
            height: "50dp"
            background_normal: ""
            background_color: hex('#172b43')
            on_release: root.manager.current = 'ana'
